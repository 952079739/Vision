<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<title>个人界面</title>
	<link rel="stylesheet" href="/static/lib/bootstrap-3.3.7-dist/css/bootstrap.min.css"/>
	<link rel="stylesheet" href="/static/lib/bootstrap-3.3.7-dist/js/bootstrap.min.js"/>
	<link rel="stylesheet" href="/static/lib/jquery/jquery-3.4.1.min.js"/>
	<link rel="stylesheet" href="../static/css/main.css" />
	<link rel="stylesheet" href="../static/css/user.css" />
	<link rel="stylesheet" href="../static/css/cuser.css" />
	<link rel="stylesheet" href="../static/css/upload.css" />
	<link rel="shortcut icon" type="image/x-icon" href="../static/img/favicon.ico" />	
</head>
<body>
	<!--导航栏 -->
	<div class="navbar navbar-default">
		<div class="container container-change">	
			
			<div class="col-sm-3 navbar-header">
			<a href="index.html" class="navbar-brand"></a>
			</div>
			
			<ul class="col-sm-7 nav navbar-nav">				
				<li><a href="{{url_for('user.update_user_two')}}">更改用户名</a></li>
				<li><a href="{{url_for('user.update_user_one')}}">更改密码</a></li>
<!--				<li><a href="#">名企校招</a></li>-->
<!--				<li><a href="#">宣讲会</a></li>-->
<!--				<li><a href="#">空中宣讲会</a></li>-->
			</ul>	
			
			<div class="col-sm-2 btn-groupn navbar-right">
			  <a class="dropdown-toggle" data-toggle="dropdown" ><span class="glyphicon glyphicon-user" id="user_name"> </span></a>
			  <ul class="dropdown-menu dropdown-menu-left">
			    <li><a href="http://127.0.0.0.1:5000/user/update_name">更改用户名</a></li>
				  <li><a href="http://127.0.0.0.1:5000/user/update_password">更改密码</a></li>
			    <li role="separator" class="divider"></li>
			    <li><a href="http://127.0.0.1:5000/user/logout">退出</a></li>
			  </ul>
			</div>
		
		</div>		
	</div>
	
	<!--个人-->	
	<div class="container user-info-top user-info-top-company clearfix">
		<div class="col-sm-2 clearfix">
			<img src="../static/img/user.png" />
		</div>
		<div class="col-sm-8 clearfix">
			<p class="info-p1" id="userinfo_name">用户名：</p>
			<p class="info-p2">
			<span id="userinfo_email">邮箱：</span>
			
			</p>			 
		</div>
		<div class="col-sm-1"></div>
		<div class="col-sm-1 user-info-top-a"></div>
	</div>
	
	<div class="container user-info-nav clearfix ">	
		<ul class="nav navbar-nav clearfix" id="company_function">				
			<li><a class="active" href="{{ url_for('user.user_info') }}">电影列表</a></li>
			<li><a href="{{ url_for('play.upload') }}" >上传</a></li>
		</ul>	
		
	</div>
			
	<div class="container  user-info">
		<div class="col-sm-9">
			<div class="user-info-right clearfix row" >
				
				<div class="user-list" id="company_function_recruit">
					{% for item in musicList %}
					<button id="movie_infomation" class="user-list-title1" >{{item.title}}</button>
					<button class="add-margin user-list-btn2" data-toggle="modal" data-target="#myModal">链接</button>
<!--					<div><div class="col-sm-5 row"><img class="img-user" src="{{item.image}}"></div>-->
<!--						<div class="col-sm-7 user-list-title2"><a href="#" class="font-size">{{item.author}}</a>-->
<!--									</div>-->
<!--									</div>-->
<!--									</div>-->
				     {% endfor %}
<!--					<div class="user-list-item1"><span>|</span> 我的电影</div>-->
<!--					<div class="container user-list-width" id="company_release">-->
						
					</div>
										
				</div>
					
			</div>
		</div>
     <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	    <div class="modal-dialog">
	        <div class="modal-content">
	            <div class="modal-header">
	                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	                <h4 class="modal-title" >链接</h4>
	            </div>
	            <div class="modal-body">
			    <p>http://39.96.2.158:5000/play/{{ session['username'] }}</p>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
			<button type="button" class="btn btn-primary" id="emp_update_btn" ><a href="http://39.96.2.158:5000/play/{{ session['username'] }}">播放</a></button>
	            </div>
	        </div>
	    </div>
	</div>

	<div>
		<div class="col-sm-3 ">
			<div class="info-worker right recommend-card">
				<!--推荐栏1-->
								
			</div>	
		</div>
	</div>
                                                        	
	 <!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
    <script src="../static/lib/jquery/jquery-3.4.1.js"></script>
    <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
    <script src="../static/lib/bootstrap-3.3.7-dist/js/bootstrap.js"></script>
    <!--自己的插件 -->
    <script>
        $(function() {
            $('#myModal').modal('hide')
       });
    	$("#company_function a").click(function(){
			$("#company_function a").removeClass("active");
			$(this).addClass("active");
		})

<!--    	$("#company_function_issue").click(function(){-->
<!--    		$("#company_function_recruit").empty()-->
<!--    		$("#company_function_recruit").append($("<div class='user-list-item1'></div>").append($("<span>|</span>")).append(" 上传电影"))-->
<!--    									  .append($("<form class='form-horizontal form-cuser' name="form" method="post" action="{{ url_for('play.doupload')}}"-->
<!--    									  enctype="multipart/form-data"></form>")-->

<!--    									  .append($("<div class='form-group'></div>")-->
<!--    									  .append($("<label class='col-sm-2 control-label'></label>").append("电影名称"))-->
<!--    									  .append($("<div class='col-sm-8'></div>").append($(" <input type='text' name='movieName' class='form-control' id='pname_add_input' >"))-->
<!--    									 ))-->

<!--    									  .append($("<div class='form-group'></div>")-->
<!--    									  .append($("<label class='col-sm-2 control-label'></label>").append("职位类型"))-->
<!--    									  .append($("<div class='col-sm-8'></div>").append($(" <input type='text' name='empName' class='form-control' id='positiont_add_input' >"))-->
<!--    									 ))-->

<!--    									  .append($("<div class='form-group'></div>")-->
<!--    									  .append($("<label class='col-sm-2 control-label'></label>").append("工作地点"))-->
<!--    									  .append($("<div class='col-sm-8'></div>").append($(" <input type='text' name='empName' class='form-control' id='postionl_add_input' >"))-->
<!--    									 ))-->

<!--    									  .append($("<div class='form-group'></div>")-->
<!--    									  .append($("<label class='col-sm-2 control-label'></label>").append("视频"))-->
<!--    									  .append($("<div class='col-sm-8'></div>").append($(" <input type='file' name='video' class='form-control' id='postions_add_input' accept="video/mp4" required/>"))-->
<!--    									 ))-->

<!--    									 .append($("<div class='form-group'></div>")-->
<!--    									  .append($("<input type='submit' class='user-submit-btn' id='company_add' value='提交'/>"))-->
<!--    									  .append($("<input type='button' class='user-submit-btn submit-btn' id='cancel_btn' value='取消'/>"))-->
<!--    									 ))-->
<!--&lt;!&ndash;    		    	$("#company_add").click(function(){&ndash;&gt;-->
<!--&lt;!&ndash;			    		var username = sessionStorage.getItem('username')&ndash;&gt;-->
<!--&lt;!&ndash;			    		var data = {&ndash;&gt;-->
<!--&lt;!&ndash;									data:JSON.stringify({&ndash;&gt;-->
<!--&lt;!&ndash;										"company_name":username,&ndash;&gt;-->
<!--&lt;!&ndash;										"position_name":$("#pname_add_input").val(),&ndash;&gt;-->
<!--&lt;!&ndash;										"position_type":$("#positiont_add_input").val(),&ndash;&gt;-->
<!--&lt;!&ndash;										"position_place":$("#postionl_add_input").val(),&ndash;&gt;-->
<!--&lt;!&ndash;										"position_treatment":$("#postions_add_input").val()&ndash;&gt;-->
<!--&lt;!&ndash;									}),			&ndash;&gt;-->
<!--&lt;!&ndash;								}&ndash;&gt;-->
<!--&lt;!&ndash;								console.log(data)	&ndash;&gt;-->
<!--&lt;!&ndash;								&ndash;&gt;-->
<!--&lt;!&ndash;						$.ajax({&ndash;&gt;-->
<!--&lt;!&ndash;							type: "post",&ndash;&gt;-->
<!--&lt;!&ndash;							url: "http://127.0.0.1:5000/company/SendDate",&ndash;&gt;-->
<!--&lt;!&ndash;							dataType: "json",&ndash;&gt;-->
<!--&lt;!&ndash;							async: false,&ndash;&gt;-->
<!--&lt;!&ndash;							data: data,&ndash;&gt;-->
<!--&lt;!&ndash;							success: function(result){&ndash;&gt;-->
<!--&lt;!&ndash;								alert(result.msg)&ndash;&gt;-->
<!--&lt;!&ndash;							}&ndash;&gt;-->
<!--&lt;!&ndash;						})&ndash;&gt;-->
<!--&lt;!&ndash;						$("#company_function_issue").click()&ndash;&gt;-->
<!--&lt;!&ndash;                	})&ndash;&gt;-->
<!--                    $("#cancel_btn").click(function () {-->
<!--                        $("#company_function_issue").click()-->
<!--                    })-->

<!--    	})-->
    	
    	$(function(){
    		username_add()
    		companyinfo_add()
    		release_build()
    		
    		//增加名字
				function username_add(){
					var date = sessionStorage.getItem('username')
					$("#user_name").append(date)
				}
				
				
			//公司信息显示
				function companyinfo_add(){
					var username = sessionStorage.getItem('username')
					var data = {
						data:JSON.stringify({
							"username":username
						}),			
					}
					console.log(data)
					$.ajax({
						type: "post",
						url: "{{ url_for('user.info') }}",
						dataType: "json",
						async: false,
						data: data,
						success: function(result){
							console.log(result)
							userinfolist = result	
							$("#userinfo_name").append(userinfolist.user_name).append('<span class="glyphicon glyphicon-check"></span>')
							$("#userinfo_email").append(userinfolist.user_email)
						}
					});								
			}
					
				
			//我的招聘
				function release_build(){
					var company_position_list
					var username = sessionStorage.getItem('username')
					var data = {
						data:JSON.stringify({
							"username":username
						}),			
					}
					
					$.ajax({
						type: "post",
						url: "http://127.0.0.1:5000/user/movie_info",
						dataType: "json",
						async: false,
						data: data,
						success: function(result){
							movie_list = result
						}
					})								
					var temp = ''	
					for (var i = 0; i<movie_list.length; i++) {
					temp += '<div class="col-sm-4 user-list-rm">'+
									'<button id="position_infomation" class="user-list-title1" >'+(movie_list[i].title).substring(0,10)+'</button>'+
									'<button class="add-margin user-list-btn2" id="delete-send">分享链接</button>'+
									'<div >'+
									'<div class="col-sm-5 row">'+
									'<img class="img-user" src="'+movie_list[i].image+'" />'+
									'</div>'+
									'<div class="col-sm-7 user-list-title2">'+
									'<a href="#" class="font-size">'+movie_list[i].author+'</a>'+
									'</div>	'+
									'</div>'+
									'</div>'
					}
					$("#company_release").append(temp)
					
				}		
				
    	})
    	
    	//取消发布
    	$(document).on("click","#delete-send",function (){
				var position_id = $(this).attr("position_id")
				var data = {
						data:JSON.stringify({
							"position_id":position_id
						}),			
					}
				console.log(data)
				$.ajax({
						type: "post",
						url: "http://127.0.0.1:5000/company/position-delete",
						dataType: "json",
						async: false,
						data: data,
						success: function(result){
							console.log(result.msg)
							location.href = "company-info.html"
						}
					})
			})


    	$(document).on("click","#position_infomation",function (){
				var position_id = $(this).attr("position_id")
				location.href="position-info.html?"+"id="+encodeURI(position_id)
			})
    </script>
    <script src="../static/js/index.js"></script>
</body>
</html>
	
